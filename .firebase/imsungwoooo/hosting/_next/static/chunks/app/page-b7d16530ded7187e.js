(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3139:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,7068,23)),Promise.resolve().then(r.bind(r,5531))},5531:(e,t,r)=>{"use strict";r.d(t,{default:()=>A});var n=r(5155),s=r(2115),a=r(7558),o=r(3264);let i=(0,r(5521).v)(e=>({fishColor:"#e7b518",fishSpeed:50,fishScale:1,darkMode:!1,score:0,setFishColor:t=>e({fishColor:t}),setFishSpeed:t=>e({fishSpeed:t}),setFishScale:t=>e(e=>({fishScale:"function"==typeof t?t(e.fishScale):t})),toggleDarkMode:()=>e(e=>({darkMode:!e.darkMode})),setScore:t=>e({score:t})}));var l=r(5321),u=r(2732);let c=new o.Pq0(-50,0,0),d=e=>{let{fishRef:t,setIsInBombZone:r,setCountdown:a}=e,{scene:d}=(0,l.p)("/models/fish.glb"),{camera:h}=(0,u.A)(),{fishColor:f,fishScale:m}=i(),[p,x]=(0,s.useState)(!1),[v,g]=(0,s.useState)(!1),w=(0,s.useRef)(null),b=(0,s.useRef)([]),j=(0,s.useRef)(null),S=(0,s.useRef)(null);return(0,s.useEffect)(()=>{let e=()=>{x(window.innerWidth<=480)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,s.useEffect)(()=>{let e=[];d.traverse(t=>{t instanceof o.eaF&&"Mesh"===t.name&&(Array.isArray(t.material)?t.material:[t.material]).forEach(t=>{t instanceof o._4j&&e.push(t)})}),b.current=e},[d]),(0,s.useEffect)(()=>{b.current.forEach(e=>e.color.set(f))},[f]),(0,s.useEffect)(()=>{let e=e=>{"d"===e.key.toLowerCase()&&g(e=>!e)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),(0,u.C)(()=>{if(!t.current)return;t.current.scale.set(m,m,m);let e=t.current.position;if(w.current&&t.current){let e=t.current,r=w.current;r.position.copy(e.position);let n=new o.Pq0(0,0,-(.5*m));n.applyEuler(e.rotation),r.position.add(n),r.rotation.copy(e.rotation),r.scale.set(1,1,1)}let n=21>Math.abs(e.x-c.x)&&21>Math.abs(e.z-c.z);n?(h.position.set(c.x,p?40:30,c.z),h.lookAt(c)):(h.position.set(e.x,20,e.z+14),h.lookAt(e)),S.current!==n&&(S.current=n,j.current&&clearTimeout(j.current),j.current=setTimeout(()=>{r(n),n&&a(3)},100))}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("primitive",{ref:t,object:d,position:[0,1,0],castShadow:!0}),v&&(0,n.jsxs)("mesh",{ref:w,children:[(0,n.jsx)("boxGeometry",{args:[1.5*m,1,5*m]}),(0,n.jsx)("meshBasicMaterial",{color:"red",wireframe:!0,transparent:!0,opacity:.5})]})]})},h=()=>{let{fishColor:e,fishSpeed:t,fishScale:r,darkMode:s,setFishColor:a,setFishSpeed:o,setFishScale:l,toggleDarkMode:u}=i();return(0,n.jsxs)("div",{className:"fish_config ".concat(s?"dark":""),children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"Fish Color: "}),(0,n.jsx)("input",{type:"color",value:e,onChange:e=>a(e.target.value)})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"Fish Speed: "}),(0,n.jsx)("input",{type:"number",value:t,onChange:e=>o(Number(e.target.value)),min:10,max:200})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"Fish Scale: "}),(0,n.jsx)("input",{type:"number",value:r,onChange:e=>l(Number(e.target.value)),min:.1,max:10,step:.1})]}),(0,n.jsx)("button",{onClick:u,type:"button",children:s?"Set LightMode":"Set DarkMode"})]})};var f=r(2660);let m=null,p=()=>null!==m?m:m=0===document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp"),x=e=>{let{planeRef:t}=e,r=(0,s.useMemo)(()=>p()?"webp":"jpg",[]),a=(0,s.useMemo)(()=>["/textures/sand/sand_02_diff_1k.".concat(r),"/textures/sand/sand_02_nor_gl_1k.".concat(r),"/textures/sand/sand_02_rough_1k.".concat(r)],[r]),[i,l,u]=(0,f.zo)(a);(0,s.useMemo)(()=>{[i,l,u].forEach(e=>{e.wrapS=e.wrapT=o.GJx,e.repeat.set(20,4)})},[i,l,u]);let c=(0,s.useMemo)(()=>(0,n.jsx)("planeGeometry",{args:[350,70]}),[]),d=(0,s.useMemo)(()=>(0,n.jsx)("meshStandardMaterial",{map:i,normalMap:l,roughnessMap:u,roughness:1,metalness:0}),[i,l,u]);return(0,n.jsxs)("mesh",{ref:t,rotation:[-Math.PI/2,0,0],position:[0,-.1,0],receiveShadow:!0,children:[c,d]})};var v=r(802);let g=new o.Pq0(-50,0,0),w=e=>{let{fishRef:t,planeRef:r,isInBombZone:n,isGameOver:a}=e,{camera:l,gl:c}=(0,u.A)(),d=(0,s.useRef)(new o.tBo),h=(0,s.useRef)(new o.I9Y),[f,m]=(0,s.useState)(!1),p=i(e=>e.fishSpeed),x=(0,s.useRef)(i.getState().fishScale),w=(e,t,r)=>Math.max(t,Math.min(r,e)),b=(e,t)=>{let r=2.5*x.current;return{x:w(e,-175+r,175-r),z:w(t,-35+r,35-r)}};return(0,s.useEffect)(()=>{let e=c.domElement,t=t=>{h.current.x=t.clientX/e.clientWidth*2-1,h.current.y=-(2*(t.clientY/e.clientHeight))+1},r=e=>{m(!0),t(e)};return e.addEventListener("pointerdown",r),e.addEventListener("pointermove",t),window.addEventListener("pointerup",()=>m(!1)),()=>{e.removeEventListener("pointerdown",r),e.removeEventListener("pointermove",t),window.removeEventListener("pointerup",()=>m(!1))}},[c]),(0,u.C)(()=>{if(a||!f||!t.current||!r.current)return;d.current.setFromCamera(h.current,l);let e=d.current.intersectObject(r.current);if(e.length>0){let r=e[0].point,s=r.x,a=r.z;if(n)s=w(r.x,g.x-21+1,g.x+21-1),a=w(r.z,g.z-21+1,g.z+21-1);else{let e=b(r.x,r.z);s=e.x,a=e.z}let i=t.current.position.distanceTo(new o.Pq0(s,r.y,a)),l=new o.Pq0(s,t.current.position.y,a);t.current.lookAt(l),v.Ay.killTweensOf(t.current.position),v.Ay.to(t.current.position,{x:s,z:a,duration:i/p})}}),null},b=Array.from({length:49},(e,t)=>{let r=Math.floor(t/7)-3;return[(t%7-3)*6,.1,6*r]}),j=e=>{let{fishRef:t,setIsGameOver:r,setIsInBombZone:a,isInBombZone:l,bombActive:u,isGameOver:c,feeds:d,setFeeds:h,countdown:f,setCountdown:m,setBombActive:p}=e,x=i(e=>e.fishScale),g=i(e=>e.score),w=(0,s.useRef)([]),[j,S]=(0,s.useState)(new Set),y=(0,s.useRef)(Math.max(500,2500-15*g)),E=(0,s.useRef)(Math.max(3,Math.min(1+Math.floor(g/15),5)));(0,s.useEffect)(()=>{y.current=Math.max(500,2500-15*g),E.current=Math.max(3,Math.min(1+Math.floor(g/15),5))},[g]),(0,s.useEffect)(()=>{let e=!1,t=async()=>{let t=f;for(;t&&t>0&&!e;)await new Promise(e=>setTimeout(e,1e3)),m(--t);e||(m(null),p(!0))};return null!==f&&t(),()=>{e=!0}},[f,m,p]),(0,s.useEffect)(()=>{if(!u||!l||c)return;let e=setInterval(()=>{i.setState(e=>({score:e.score+1}))},1e3);return()=>clearInterval(e)},[u,l,c]),(0,s.useEffect)(()=>{if(!u||c||!l||d.length>0)return;let e=setInterval(()=>{if(0===d.length){let e=(Math.floor(7*Math.random())-3)*6-50,t=(Math.floor(7*Math.random())-3)*6;h([{id:crypto.randomUUID(),position:[e,1,t]}])}},1e3);return()=>clearInterval(e)},[u,c,l,d,h]);let k=(0,s.useCallback)((e,t)=>{let r=e.position.clone(),n=new o.Pq0(...b[t]).add(new o.Pq0(-50,0,0)),s=new o.Pq0(0,0,1).applyEuler(e.rotation).normalize(),a=new o.Pq0().subVectors(n,r),i=2*x,l=5*x,u=Math.abs(a.dot(s)),c=new o.Pq0().crossVectors(s,new o.Pq0(0,1,0)),d=Math.abs(a.dot(c));return u<3+l/2&&d<3+i/2},[x]),C=(0,s.useCallback)((e,t)=>{let n=new Set(j);e.forEach(e=>{if(n.has(e))return;let t=w.current[e];if(!t)return;let r=t.material.color;v.Ay.to(r,{r:1,g:0,b:0,duration:3,ease:"power1.inOut"}),n.add(e)}),S(n),setTimeout(()=>{e.forEach(e=>{let n=w.current[e];n&&n.material.color.set("white"),n&&t&&k(t,e)&&(r(!0),a(!1))})},3e3)},[j,k,r,a]);return(0,s.useEffect)(()=>{if(!u||c)return;let e=t.current;if(!e)return;let r=setInterval(()=>{let t=[...Array(b.length).keys()].filter(e=>!j.has(e));if(0===t.length)return;let r=[];for(let e=0;e<E.current&&t.length>0;e++){let e=t.splice(Math.floor(Math.random()*t.length),1)[0];r.push(e)}C(r,e)},y.current);return()=>clearInterval(r)},[u,c,t,j,C]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("group",{position:[-50,0,0],children:b.map((e,t)=>(0,n.jsxs)("group",{position:e,children:[(0,n.jsxs)("mesh",{ref:e=>e&&(w.current[t]=e),children:[(0,n.jsx)("boxGeometry",{args:[6,.1,6]}),(0,n.jsx)("meshStandardMaterial",{color:"white"})]}),(0,n.jsxs)("lineSegments",{children:[(0,n.jsx)("edgesGeometry",{args:[new o.iNn(6,.1,6)]}),(0,n.jsx)("lineBasicMaterial",{color:"black"})]})]},t))}),d.map(e=>{let{id:r,position:s}=e;return(0,n.jsx)(M,{position:s,fishRef:t,isGameOver:c,onCollected:()=>{if(c)return;h([]),setTimeout(()=>{let e=(Math.floor(7*Math.random())-3)*6-50,t=(Math.floor(7*Math.random())-3)*6;h([{id:crypto.randomUUID(),position:[e,1,t]}])},500);let e=i.getState().fishScale,t=Math.floor(20*e);i.setState(e=>({score:e.score+t}));let r=.1*Math.exp(-e),n=Math.min(3,parseFloat((e+r).toFixed(2)));i.getState().setFishScale(n);let s=Math.max(10,50-8*n);i.getState().setFishSpeed(parseFloat(s.toFixed(2)))},onExpire:()=>h([])},r)})]})},S=(e,t,r,n,s,a,o)=>{e.current&&e.current.position.set(0,1,0),t(!1),r(!1),n(!1),s(0),a(null),o([]),i.getState().setFishScale(1),i.getState().setFishSpeed(50)},M=e=>{let{position:t,fishRef:r,onCollected:a,isGameOver:o,onExpire:i}=e,l=(0,s.useRef)(null),c=(0,s.useRef)(.1),[d,h]=(0,s.useState)(!0),f=(0,s.useCallback)(()=>{if(!l.current||o||!d)return;let e=setInterval(()=>{if(!l.current||!d){clearInterval(e);return}c.current<=0?(clearInterval(e),h(!1),i()):(c.current=Math.max(0,c.current-.05),l.current.scale.setScalar(c.current))},1e3/60)},[o,d,i]);return((0,s.useEffect)(()=>{c.current>=1&&setTimeout(f,500)},[f]),(0,u.C)(()=>{if(o||!l.current||!r.current||!d)return;c.current<1&&(c.current+=.005,l.current.scale.setScalar(c.current));let e=l.current.position,t=r.current.position;1.5>e.distanceTo(t)&&d&&(h(!1),a())}),(0,s.useEffect)(()=>{l.current&&l.current.position.set(...t)},[t]),d)?(0,n.jsxs)("mesh",{ref:l,children:[(0,n.jsx)("sphereGeometry",{args:[.5,16,16]}),(0,n.jsx)("meshStandardMaterial",{color:"limegreen"})]}):null};var y=r(3035);let E=()=>{let e=(0,y.M)("/videos/caustics.mp4");return(0,n.jsxs)("mesh",{rotation:[-Math.PI/2,0,0],position:[0,.01,0],renderOrder:10,children:[(0,n.jsx)("planeGeometry",{args:[350,70]}),(0,n.jsx)("meshBasicMaterial",{map:e,transparent:!0,opacity:.3,depthWrite:!1,depthTest:!1})]})},k=e=>{let{darkMode:t}=e,{scene:r}=(0,u.A)(),n=(0,s.useRef)(!1);return(0,s.useEffect)(()=>{n.current||(r.background instanceof o.Q1f||(r.background=new o.Q1f(t?"#0b0b0b":"#0c6ceb")),r.fog||(r.fog=new o.cRK(new o.Q1f(t?"#111111":"#00bfff"),.02)),n.current=!0);let e=new o.Q1f(t?"#0b0b0b":"#0c6ceb"),s=new o.Q1f(t?"#111111":"#00bfff");r.background instanceof o.Q1f&&v.Ay.to(r.background,{r:e.r,g:e.g,b:e.b,duration:.7,ease:"power2.inOut"}),r.fog&&r.fog.color&&v.Ay.to(r.fog.color,{r:s.r,g:s.g,b:s.b,duration:.7,ease:"power2.inOut"})},[r,t]),null};var C=r(8310),R=r(6408);let _=e=>{let{renderTarget:t,loadingComplete:r,onFinish:a}=e,i=(0,s.useRef)(null),{size:l}=(0,u.A)(),c=(0,s.useMemo)(()=>{let e=document.createElement("canvas");e.width=1024,e.height=512;let t=e.getContext("2d"),r=t.createLinearGradient(0,0,e.width,e.height);r.addColorStop(0,"rgba(131, 58, 180, 1)"),r.addColorStop(.5,"rgba(253, 29, 29, 1)"),r.addColorStop(1,"rgba(252, 176, 69, 1)"),t.fillStyle=r,t.fillRect(0,0,e.width,e.height),t.fillStyle="#ffffff",t.font="bold 80px sans-serif",t.textAlign="center",t.textBaseline="middle",t.fillText("Loading...",e.width/2,e.height/2);let n=new o.GOR(e);return n.needsUpdate=!0,n},[]),d=(0,s.useMemo)(()=>({time:{value:0},progress:{value:0},width:{value:.35},radius:{value:.9},texture1:{value:c},texture2:{value:t.texture},resolution:{value:new o.IUQ}}),[c,t.texture]);return(0,s.useEffect)(()=>{if(!r)return;let e=setTimeout(()=>{v.Ay.to(d.progress,{value:1,duration:1.7,ease:"power2.out",onComplete:a})},500);return()=>clearTimeout(e)},[r,d.progress,a]),(0,u.C)(()=>{var e;d.time.value+=.05;let t=l.height/l.width,r=t>.5?l.width/l.height*.5:1;d.resolution.value.set(l.width,l.height,r,t>.5?1:t/.5),null===(e=i.current)||void 0===e||e.scale.set(l.width,l.height,1)}),(0,n.jsxs)("mesh",{ref:i,position:[0,0,0],children:[(0,n.jsx)("planeGeometry",{args:[1,1]}),(0,n.jsx)("shaderMaterial",{vertexShader:C.A,fragmentShader:R.A,uniforms:d})]})},A=()=>{let[e,t]=(0,s.useState)(!0),[r,l]=(0,s.useState)(!1),[u,c]=(0,s.useState)(!0),f=(0,s.useRef)(null),m=(0,s.useRef)(null),p=i(e=>e.darkMode),[v,g]=(0,s.useState)(!1),[b,M]=(0,s.useState)(!1),[y,C]=(0,s.useState)(null),[R,A]=(0,s.useState)(!1),[F,I]=(0,s.useState)([]),z=i(e=>e.score),L=i(e=>e.setScore),O=(0,s.useMemo)(()=>new o.nWS(1024,512),[]);(0,s.useEffect)(()=>{let e=setTimeout(()=>{t(!1),l(!0)},1500);return()=>clearTimeout(e)},[]),(0,s.useEffect)(()=>{r&&O.dispose()},[r,O]);let P=(0,s.useCallback)(()=>{S(f,M,g,A,L,C,I)},[L]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.Hl,{shadows:!0,camera:{position:[0,17,14],fov:75},children:[(0,n.jsx)(k,{darkMode:p}),(0,n.jsx)("ambientLight",{color:0xffffff,intensity:.8}),(0,n.jsx)("directionalLight",{color:0xf8f8ff,intensity:4,position:[2,1,3],castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-camera-left":-200,"shadow-camera-right":200,"shadow-camera-top":200,"shadow-camera-bottom":-200,"shadow-camera-near":1,"shadow-camera-far":500}),(0,n.jsx)(E,{}),!e&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d,{fishRef:f,setIsInBombZone:g,setCountdown:C}),(0,n.jsx)(x,{planeRef:m}),(0,n.jsx)(j,{fishRef:f,setIsGameOver:M,setIsInBombZone:g,isInBombZone:v,bombActive:R,isGameOver:b,feeds:F,setFeeds:I,countdown:y,setCountdown:C,setBombActive:A}),(0,n.jsx)(w,{fishRef:f,planeRef:m,isInBombZone:v,isGameOver:b})]})]}),u&&(0,n.jsx)("div",{className:"shader_container",children:(0,n.jsx)(a.Hl,{orthographic:!0,camera:{zoom:1,position:[0,0,100]},children:(0,n.jsx)(_,{renderTarget:O,loadingComplete:r,onFinish:()=>c(!1)})})}),(0,n.jsx)(h,{}),(0,n.jsxs)("div",{className:"hud",children:[null!==y&&(0,n.jsxs)("div",{className:"countdown",children:["폭탄 시작까지: ",y]}),R&&(0,n.jsxs)("div",{className:"score",children:["점수: ",z]})]}),b&&(0,n.jsxs)("div",{onClick:P,className:"gameover_overlay",children:[(0,n.jsx)("h1",{children:"YOU'RE COOKED"}),(0,n.jsx)("p",{children:"화면을 클릭해 다시 시작하세요"})]})]})}},6408:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n="uniform float time;\r\nuniform float progress;\r\nuniform float width;\r\nuniform float radius;\r\nuniform sampler2D texture1;\r\nuniform sampler2D texture2;\r\nuniform vec4 resolution;\r\nvarying vec2 vUv;\r\n\r\nfloat parabola(float x, float k) {\r\n  return pow(4. * x * (1. - x), k);\r\n}\r\n\r\nvoid main() {\r\n  vec2 newUV = (vUv - vec2(0.5)) * resolution.zw + vec2(0.5);\r\n  vec2 start = vec2(0.5, 0.5);\r\n  vec2 aspect = resolution.wz;\r\n  float prog = progress * 0.66;\r\n  float circ = 1. - smoothstep(-width, 0.0, radius * distance(start * aspect, newUV * aspect) - prog * (1. + width));\r\n  float intpl = pow(abs(circ), 1.);\r\n  vec4 t1 = texture2D(texture1, (newUV - 0.5) * (1.0 - intpl) + 0.5);\r\n  vec4 t2 = texture2D(texture2, (newUV - 0.5) * intpl + 0.5);\r\n  gl_FragColor = mix(t1, t2, intpl);\r\n}\r\n"},7068:e=>{e.exports={container:"page_container__LLik5"}},8310:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n="varying vec2 vUv;\r\nvoid main() {\r\n  vUv = uv;\r\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n}\r\n"}},e=>{var t=t=>e(e.s=t);e.O(0,[15,831,367,413,592,910,558,802,498,441,684,358],()=>t(3139)),_N_E=e.O()}]);